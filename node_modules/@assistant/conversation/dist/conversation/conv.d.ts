/**
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *    http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
import * as Schema from '../api/schema';
import { Headers } from '../framework';
import { Prompt, PromptItem } from './prompt';
import { JsonObject } from '../common';
import { User, Home, Expected } from './handler';
import { ILogger } from '../logger';
/** @hidden */
export interface ConversationV3Options {
    /** @public */
    body?: Schema.HandlerRequest;
    /** @public */
    headers?: Headers;
    /** @public */
    clientId?: string;
    /** @public */
    debug?: boolean;
    /** @public */
    logger?: ILogger;
    /**
     * Validates whether request is from Google through signature verification.
     * Uses Google-Auth-Library to verify authorization token against given Google Cloud Project ID.
     * Auth token is given in request header with key, "authorization".
     *
     * HTTP Code 403 will be thrown by default on verification error.
     *
     * @example
     * ```javascript
     *
     * const app = conversation({ verification: 'nodejs-cloud-test-project-1234' })
     * ```
     *
     * @public
     */
    verification?: ConversationVerification | string;
}
/** @hidden */
export interface ConversationOptions {
    /** @public */
    request?: Schema.HandlerRequest;
    /** @public */
    headers?: Headers;
}
/** @public */
export interface ConversationVerification {
    /**
     * Google Cloud Project ID for the Assistant app.
     * @public
     */
    project: string;
    /**
     * Custom status code to return on verification error.
     * @public
     */
    status?: number;
    /**
     * Custom error message as a string or a function that returns a string
     * given the original error message set by the library.
     *
     * The message will get sent back in the JSON top level `error` property.
     * @public
     */
    error?: string | ((error: string) => string);
}
/** @public */
export declare class ConversationV3 {
    /** @public */
    request: Schema.HandlerRequest;
    /** @public */
    headers: Headers;
    /**
     * Get the current handler information like handler name.
     *
     * @example
     * ```javascript
     *
     * app.handle('handler name', conv => {
     *   const handlerName = conv.handler.name
     * })
     * ```
     *
     * @public
     */
    handler: Schema.Handler;
    /** @public */
    intent: Schema.Intent;
    /** @public */
    scene: Schema.Scene;
    /** @public */
    session: Schema.Session;
    /** @public */
    user: User;
    /** @public */
    device: Schema.Device;
    /** @public */
    home: Home;
    /** @public */
    expected: Expected;
    /** @public */
    context: Schema.Context;
    /** @public */
    prompt: Prompt;
    /** @public */
    overwrite: boolean;
    /** @public */
    digested: boolean;
    /** @public */
    body: Schema.HandlerRequest;
    /** @hidden */
    _internal: {
        raw?: JsonObject;
        promptSet: boolean;
        orig: {
            scene: Schema.Scene;
            session: Schema.Session;
            user: Schema.User;
            home: Schema.Home;
        };
    };
    /** @hidden */
    constructor(options?: ConversationV3Options);
    /** @public */
    json<T = JsonObject>(json: T): this;
    /**
     * Add prompt items to be sent back for fulfillment.
     *
     * Prompt items are limited to 2 simple responses.
     * More than 2 will result in an error in fulfillment.
     * The first simple added in order will be set to `firstSimple`.
     * The last simple added in order will be set to `lastSimple`.
     *
     * @example
     * ```javascript
     *
     * const app = conversation()
     *
     * app.handle('main', conv => {
     *   const ssml = '<speak>Hi! <break time="1"/> ' +
     *     'I can read out an ordinal like <say-as interpret-as="ordinal">123</say-as>. ' +
     *     'Say a number.</speak>'
     *   conv.add(ssml)
     * })
     * ```
     *
     * @param promptItems A response fragment for the library to construct a single complete response
     * @public
     */
    /** @public */
    add(...promptItems: PromptItem[]): this;
    /**
     * Append speech responses to be sent back for fulfillment.
     *
     * @example
     * ```javascript
     *
     * const app = conversation()
     *
     * app.handle('handler name', conv => {
     *   const ssml = '<speak>Hi! <break time="1"/> ' +
     *     'I can read out an ordinal like <say-as interpret-as="ordinal">123</say-as>. ' +
     *     'Say a number.</speak>'
     *   conv.append(ssml)
     * })
     * ```
     *
     * @param speech A speech string to be appended
     * @public
     */
    /** @public */
    append(speech: string): this;
    /** @public */
    response(): Schema.HandlerResponse;
    /** @public */
    serialize(): Schema.HandlerResponse;
}
export interface ExceptionHandler<TConversation extends ConversationV3> {
    /** @public */
    (conv: TConversation, error: Error): Promise<any> | any;
}
